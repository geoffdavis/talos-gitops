apiVersion: external-secrets.io/v1beta1
kind: ExternalSecret
metadata:
  name: oauth2-proxy-secret
  namespace: kubernetes-dashboard
spec:
  secretStoreRef:
    name: onepassword-connect
    kind: SecretStore
  target:
    name: oauth2-proxy-secret
    creationPolicy: Owner
  data:
  - secretKey: client-secret
    remoteRef:
      key: kubernetes-dashboard-oauth2
      property: client_secret
  - secretKey: cookie-secret
    remoteRef:
      key: kubernetes-dashboard-oauth2
      property: cookie_secret
---
# Manual secret for testing (replace with actual values)
# To generate cookie secret: python -c 'import os,base64; print(base64.urlsafe_b64encode(os.urandom(32)).decode())'
apiVersion: v1
kind: Secret
metadata:
  name: oauth2-proxy-secret-manual
  namespace: kubernetes-dashboard
type: Opaque
stringData:
  client-secret: "REPLACE_WITH_AUTHENTIK_CLIENT_SECRET"
  cookie-secret: "REPLACE_WITH_GENERATED_COOKIE_SECRET"